#+TITLE: Fundamentos de Blockchain
#+DESCRIPTION: Serie que recopila una aprendizaje sobre blockchain
#+AUTHOR: Sergio Benítez
#+DATE:<2021-10-27 Wed> 
#+STARTUP: fold
#+HUGO_BASE_DIR: ~/Development/suabochica-blog/
#+HUGO_SECTION: /post
#+HUGO_WEIGHT: auto
#+HUGO_AUTO_SET_LASTMOD: t

Tiempo de explorar los componentes fundamentales del Blockchain. Para ello se va a romper lo que inicialmente puede parecer una caja negra y reconocer así el sistema subyacente al Blockchain. Es importante tener unas bases fuertes sobre dichos conceptos ya que en el futuro ayudarán a entender con facilidad los conceptos avanzados.

Para aterrizar estos conceptos, se va a implementar un proyecto que consiste en la creación y administración de identidad en un Blockchain. Para ello se va a estar revisando con frecuencia la siguiente gráfica conocida como el Blockchain Framework:

#+CAPTION: Blockchain Framework
[[../../images/blockchain/01-blockchain-framework.png]]


El Blockchain Framework provee una viste general de los componentes claves del Blockchain, y puede ser interpretado como un mapa de ruta para el entendimiento de Blockchain.

Al ser Blockchain una tecnología nueva, es importante dedicar tiempo en el entendimiento de sus fundamentos. Hay que tener en cuenta que Blockchain es una tecnología que todavía se esta explorando y por ende sus avances vienen respaldados por una serie de reglas y regulaciones sobre el protocolo. Con el proyecto de identidad en Blockchain se va a reforzar el entendimiendo del protocolo, ya que motiva la uso de servicios que se van a crear en una aplicación para lograr establecer identidad en los servicios de Blockchain.

El Blockchain empezó como una forma para intentar resolver algunos problemas vistos en las transacciones financieras. Por los tantos es importante revisar en que consisten estás transacciones y discutir las soluciones que Blockchain ofrece.

* Transacciones Financieras
  
Para entrar al contexto financiero es importante hacerse las siguientes preguntas: ¿Qué hace que el dinero sea valioso? ¿Por qué la gente lo usa? ¿Hay alguna forma de mejorar el sistema acutal?. Para responder estas preguntas es necesario descomponer como funciona el sistema financiero actual.

Imagine un contexto financiero en donde no se ha realizado ninguna transacción. El objetivo es crear un sistema que le permita a la gente hacer transacciones. Para empezar, considere que cada persona tiene un tipo de producto o servicio y hay personas que necesitan estos productos y servicios. Para acceder a dichos productos las personas que lo ofrecen esperan algo a cambio por dicho producto. El problema inicial es que no se tiene ningun mecanismo para hacer transacciones entre ellos. Para solucionar esto se puede empezar a comerciar. Primero se debe dar un valor al producto que una persona esta ofreciendo. Hecho esto ya se esta en capacidad de negociar el producto con los demás.

Este es un buen comienzo pero ahora se enfrenta un nuevo problema; nadie podrá ponerse de acuerdo con el valor exacto del producto o servicio que se esta ofreciendo. Para ello, hay que valerse de algo en lo que todos estén de acuerdo y tenga cierto valor intrínseco, algo como el oro empieza a tener protagonismo en el sistema de transacciones. Si se puede definir el valor de un producto en términos de cierta cantidad de oro, se podrá definir el valor de todos los productos basados en la referencia del oro, y yendo más alla, se puede hacer una divisa para empezar a negociar en lugar del oro. Es decir que ahora se tiene dinero.

Con el dinero en contexto, es necesario que alguien empiece a rastrear y administrar las transacciones que se están haciendo en el sistema. Es aquí donde los bancos entran. Los banco mantienen la traza de las transacciones para conservar el dinero seguro y protegido. Su figura se conoce como un /tercero de confianza/, que en pocas palabras es una entidad que facilita la interacción entre dos partes (Esta figura va a tener protagonismo en el contexto del Blockchain). A través del banco se establece la seguridad que se necesita para almacenar el dinero y confiar en las transacciones.

Esto es algo valioso y los banco lo logran al manejar un /libro mayor/ con la lista de todas las transacciones registradas. La información en este libro mayor contiene a la persona que envía el dinero, la persona que lo recibe ,cuando ocurrio y el monto enviado. La siguiente imagen resume la figura del /libro mayor/:

#+CAPTION: Transacciones financieras actuales
[[../../images/blockchain/02-current-financials-transactions.png]]

Este libro mayor nos permite saber quién tiene dinero, quién debe dinero y cuanto dinero existe. Esta información puede ser utilizada para fomentar la confianza entre la gente que esta haciendo transacciones sin necesidad de conocerse entre ellos. Este mecanismo ayuda a resolver el problema del doble gasto, el cual sucede cuando una persona gasta la misma cantidad de dinero en más de una ocasión. En un sistema financiero prevenir este problema es importante ya que evita que la gente duplique dinero. Por mucho tiempo se ha usado el libro mayor como mecanismo de defensa al problema del doble gasto, ya que se pueden invalidar las transacciones duplicadas. No obstante, Blockchain ofrece una alternativa diferente para afrontar el problema del doble gasto.

** Problemas con el sistema actual

Estos son los problemas que presenta el sistema financiero actual: No hay una forma fácil de ver si las transacciones han sido manipuladas. Por otra parte, el tiempo de la transacción depende de los bancos para validar las transacciones.

Evidentemente se pueden afinar estas características y se recuerda que Blockchain fue creado con el objetivo de mejorar el sistema financiero. Su propuesta inicial es tratar de remplazar los bancos como un tercero de confianza. Si esto funciona o no, es algo que todavía se esta definiendo.

En detalle esta es la propuesta de Blockchain: Actualmente todos los bancos recopilan toda la información que es crucial en el sistema financiero y también tienen control total sobre los datos que se manejan allí. Es decir, tienen acceso a todos los movimientos de nuestro dinero y están en capacidad de escoger si quieren compartir esta infomación con sus clientes. Quizás sería mejor que todo el mundo tuviera acceso a estos registros y en vez de tener un libro mayor mantendio por el banco, se podría crear un libro mayor compartido al cual todo el mundo pudiera acceder. De ser esto posible, todo el mundo tendría control completo sobre su información. En resumidas cuentas, el Blockchain hace posible que se puedan omitir los terceros en las transacciones, haciendo que el dinero se envía más rapido y reduciendo los impuestos asociados al simple hecho de hacer una transacción.

Algo que se debe anotar, es que todavía no se sabe si esta propuesta funciona realmente. No obstante, se ha manifestado un maravilloso progreso hasta ahora. Se resalta que las propuestas de Blockchain estan en construcción. Blockchain no es una solución definitiva, es más bien una alternativa que debe ser contemplada y probada para validar su efectividad. La invitación esta abierta a hacer parte de esta solución. 

* Introducción al Bitcoin

La cadena de bloques es un tema enorme que abarca muchas plataformas e industrias. Con tanto que aprender y las nuevas actualizaciones que ocurren todos los días, es difícil saber por dónde empezar. Creemos que el mejor lugar para comenzar es donde todo comenzó: ¡con Bitcoin!

Los conceptos e ideas que desarrolló Bitcoin continúan influyendo en todas las demás cadenas de bloques. Por esa razón, usaremos bitcoin como una forma de ayudar a recorrer algunos conceptos importantes del programa.

** ¿Qué es Bitcoin?

El Blockchain empezó con su primera implementación usando un nuevo tipo de moneda conocido como Bitcoin.

#+begin_quote
Bitcoin es una moneda digital que utiliza el Blockchain para facilitar las transacciones finacieras
#+end_quote

Bitcoin sentó las bases para otras ideas subyacentes a otras cadenas de bloques. Por lo tanto entedende com funciona Bitcoin es un paso importante para entender las ideas que se están presentando sobre todas las industrias.

Bitcoin usa la idea de bloques para agrupar y validar transacciones. Un bloque es un grupo de transacciones. Bitcoin es una secuela de un árticulo publicado en 1991 por Stuart Haber y Scoot Stornetta llamado [[https://www.anf.es/pdf/Haber_Stornetta.pdf][How to Time-Stamp a Digital Document]] en donde se presenta la idea de agrupar, validar y enlazar documentos. En dicho árticulo también se explica como esta estructura forma una cadene de docuemntos al dia completamente validados.

En 2008, un autor bajo el alias de Satoshi Nakamoto publicado un árticulo llamado Blockchain: [[https://bitcoin.org/bitcoin.pdf][A Peer-to-Peer Electronic Cash System]] en donde se comparte todas las bases del Bitcoin que se conoce hoy en día. Este árticulo cambio por completo la forma en la que la socieda entiende una  divisa. El 3 Enero del 2009, Nakamoto liberó el software de Bitcoin, Desatando los primeros Bitcoins al mundo. En dicho árticulo se comparte los fundamentos del Bitcoin, Blockchain y otro tipo de criptomonedas. Por lo tanto se recomiendo realizar la lectura del árticulo teniendo en cuenta las siguientes preguntas:

- ¿Cuál es el problema que Bitcoin soluciona?
- ¿Qué soluciones ofrece Bitcoin?
- ¿Qué componentes son usados para desarrollar es sistema de Bitcoin?

Muchos de los conceptos expuestos por Nakamoto se extienden del contexto de Bitcoin y las criptomonedas, puesto que estos conceptos son la base de la construcción de un Blockchain robusta para cualquier aplicación.

Sorprendentemente, solo hasta que Bitcoin fue desarrollado se empezó a populizar el potencial de la tecnología subyacente al sistema, el Blockchain. Abstraer esta ideas a aplicacione diferentes a contexto finacieros y criptomonedas es como Blockchain esta en capacidad de empezar a transformar muchas industrias.

 Una conclusión importante es: Bitcoin no es el Blockchain, es un Blockchain.

Actualmente hay muchas cadenas de bloques, e incluso se va a construir una propia. La idea es también repasar otras cadenas de bloques y plataformas. No obstante se comienza con Bitcoin porque una vez se comprendan estas ideas básicas, podrá aplicarlas en cualquier lugar.

* Hashing

Hasing es una idea que ya se menciono anteriormente. Básicamente es una forma de crear una huella dactilar digital para una pieza de datos. Es una idea fundamental para lograr que el Blockchain funcione, y ademas es un punto de partida para conectar dinámicas más avanzadas dentro de la cadena de bloque.

En la siguiente gŕafica se resalta la parte del framework que se va a a desarrollar en esta sección:

#+CAPTION: Hashsing Component
[[../../images/blockchain/03-blockchain-hashing.png]]

Un /Valor Hash/ es na huella digital para información. Es una cadena de caracteres de texto y números que representa un conjunto de datos. Estos datos se pasan a través de una /Función de Hashing/. Esta función mapea un grupo de datos a un valor único de hash. Ese valor hash se convierte en el único de acceso a los datos agrupados por la función. El término SHA256 corresponde a una funcíon de hash. SHA significa Secure Hashing Algorithm, y el 256 representa la salida del algoritmo. Para este caso el valor hash es un número en 256 bits. Bitcoin usa el SHA256 para crear un valor hash único al bloque que componen la cadena de bloques. La siguente gráfica muestra la relación de un bloque, con una función hash y un valor hash:

#+CAPTION: SHA256
[[../../images/blockchain/04-SHA256.png]]

Los hashes son utilizados para referenciar bloques dentro de la cadena y también para identificar las uniones de bloques en el Blockchain. Para entender como funciona la cadena, es necesario entender como funcionan los bloques en si mismo, tema que se abordará en la siguiente sección.

** Hashign Demo

Ahora que se tienen una idea de como funcionan los valores hash, se puede hacer una pequeña demonstración. La idea es visitar [[https://andersbrownworth.com/blockchain/hash][anders.com]] y en la pestaña Hashs empezar a introducir contenidos aleatorios como textos y números. Los importante a tener en cuenta aquí es que cada vez quese modifica el contenido el valor del hash es actualizados y dicho valor es único. 

Eso concluye esta introducción al hash. Tenga en cuenta estas ideas a medida que avanzamos en la lección. Cada una de estas nuevas ideas se complementan entre sí. Es útil comprender cada uno de ellos de forma aislada para que esté mejor preparado para verlos como un sistema más adelante.

* Bloques

Los bloques son un componente fundamental del Blockchain. La palabla "bloque" es una forma apropiada de pensar cmo la información es almacenada. No obstante el bloque es un poco más complejo de lo que inicialmente se espera.Por lo tanto, en esta sección  se va a revisar que es un bloque puntualmente, ¿por qué son importantes? y las bases para entender cómo funcionan.

#+CAPTION: Blocks Component
[[../../images/blockchain/05-blockchain-blocks.png]]

Un /Bloque/ es un contenedor de una lista de transacciones que se agregarán a la cadena de bloques. Como se ha visto el Blockchain es una libro mayor digital compartido que registra una lista de transacciones que se realizar en una red. Tener una lista gigante de transacciones fomenta una gestión tediosa sobre la misma. La propuesta de Blockchain es separar esta lista gigante de transacciones en secciones pequeñas llamadas bloques. A medida de que las transacciones son hechas, estas van siendo empaquetadas en los bloques y agregadas al Blockchain. Al tener la separación de bloques se puede gestionar el sistema entero de manera más eficiente.

A demás de las transacciones, los bloques tambien contienen otro tipo de información. A mayor detalle el bloques se compone de dos partes: un encabezado y un cuerpo. En el cuerpo se guarda la transacciones como tal y en el encabezado se tienen detalles sobre la estructura de los datos que están dentro del bloques. la siguiente lista recopila los detalles que se encuentran en un encabezado del bloque:

- Valor hash del bloque previo
- El tiempo en el que el bloque fue hecho
- La raíz Merkle
- Nonce

El *valor hash del bloque previo*, se explica por si solo. Lo importante de esta información es que suministra lo necesario para identificar de manera sencilla que bloque viene después o antes de otro bloque en el Blockchain. En otras palabras, esta es la base que forma el Blockchain entero.

El *tiempo* en el que el bloque fue creado también se explica por si solo. Su uso corresponde a identificar de manera precisa cuando ciertas transacciones fueron ejecutadas y pude ayudar a atrapar casos como cuando alguién intenta gastar el mismo dinero dos veces, ya que la información registrada permite saber cual transacción fue válidbasado en cual se presentó primero. Este sello de tiempo es la solución al problema de doble gasto que se menciono en la primera publicación de esta serie.

*La raíz Merkle*, es el hash que representa cada transacción dentro del bloque. Para obtenerlo, un par de las transacciones que están dentro del bloque son agrupadas rápidamente y cada par se representa con un hash único. Luego el hash de las dos parejas de transacciones es nuevamente agrupado para generar otro hash único. Este proceso se repite recursivamente hasta lograr a un valor hash único con todas las transacciones dentro del bloque. Este valor hash final es conocido como la raíz de Merkle. Con este proceso, ahora es posible revertir cada uno de los valores hash dentro del bloque para realizar una búsqueda sobre la transacción original que se alamcenó en el bloque. Todo partiendo desde la raíz de Merkle.

Por último, El *Nonce* tiene más que ver con algunos temas de minería que se van a desarrollar más adelante, pero una introducción rápida es que el nonce es un número arbitrario que solo puede ser utilizado una vez. Cuando se crea un hash para un bloque no cualquier valor va a funcionar. El sistema solicitará un valor hash específico que comienza con cierto número de ceros. Estás restricciones adicionales hacen que el hash sea más díficil de encontrar. Para resolver este valor, se deben combinar todos los bloques de datos con el nonce para tratar de generar el valor hash correcto. Los computadores adivinan una y otra vez el nonce hasta que finalmente obtienen el valor que cumple con las restricciones. La cantindad de ceros al inicio del nonce es conocido como la dificultad del bloque.

Paralelo al encabezado, se tiene una información adicional que corresponde al tamaño del bloque. El tamaño del bloque es la cantidad de espacio que un bloque tiene para almacenar información, y funciona tal cual los limitantes de espacio que tienen los computadores o los dispositivos móviles. Este tamaño es definido por el desarrollador y ayuda a controlar cosas como cuánto tiempo tomará un bloque en completarse o cuántos bloques estarán en la cadena. Una vez decidido, todos los bloques en la cadena tendrán el mismo tamaño y solo podrá ser modificado cuando se actualiceel software.

El último dato adicional es de un bloque es un valor del hash de si mismo, el cuál servirá para identificarlo en el futuro. Si los datos del bloque son modificados, un nuevo valor hash será generado. Esto es importante ya que permite saber cuando un bloque ha sido manipulado, haciendo así el Blockchain una forma segura para mantener el historial de la información que usted está compartiendo.
